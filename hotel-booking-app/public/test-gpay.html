<!DOCTYPE html>
<html>
<head>
  <title>Payment Request Button Test</title>
  <script src="https://js.stripe.com/v3/"></script>
  <style>
    /* Add some basic styling to center the button */
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
  </style>
</head>
<body>

  <div id="payment-request-button">
    </div>

<script>
  // Replace with your own publishable key
  const stripe = Stripe('pk_live_51ReJLvCjVfQnXx6IL588OtoPKEHLfFNSyfzVYjlTBxEYSpV4zx0o4NR4UDrcemoDElCHVDXalVnScI4Z35CQjPEI00d7X8fN8o');

  const paymentRequest = stripe.paymentRequest({
    country: 'US',
    currency: 'usd',
    total: {
      label: 'Demo total',
      amount: 1099,
    },
    requestPayerName: true,
    requestPayerEmail: true,
  });

  const elements = stripe.elements();
  const prButton = elements.create('paymentRequestButton', {
    paymentRequest: paymentRequest,
  });

  // Check the availability of the Payment Request API first.
  paymentRequest.canMakePayment().then(function(result) {
    if (result) {
      prButton.mount('#payment-request-button');
    } else {
      document.getElementById('payment-request-button').style.display = 'none';
      console.log("Google Pay is not available. Please check your browser and payment methods.");
    }
  });

  paymentRequest.on('paymentmethod', function(ev) {
    // Confirm the PaymentIntent without handling potential next actions (yet).
    stripe.confirmCardPayment(
      clientSecret,
      {payment_method: ev.paymentMethod.id},
      {handleActions: false}
    ).then(function(confirmResult) {
      if (confirmResult.error) {
        // Report to the browser that payment failed
        ev.complete('fail');
      } else {
        // Report to the browser that payment was successful, prompting
        // it to close the browser payment interface.
        ev.complete('success');
        // Let Stripe.js handle the rest of the payment flow.
        stripe.confirmCardPayment(clientSecret).then(function(result) {
          if (result.error) {
            // The payment failed -- ask your customer for a new payment method.
          } else {
            // The payment has succeeded.
          }
        });
      }
    });
  });
</script>
</body>
</html>